---
sidebarDepth: 0
---

# package-lock.json

[[toc]]

## 关于 package-lock.json，你需要知道的一些事情

- 若是你使用的`npm 5.0.0`及以上的版本，`package-lock.json`会默认自动生成。
- 你应该使用`package-lock.json`来确保一致的安装和兼容的依赖关系。
- 你应该将`package-lock.json`提交到源代码仓库

## npm 5.0.0 以后的版本变化

参考: [npm install 生成的package-lock.json是什么文件？有什么用？](https://www.zhihu.com/question/62331583)

`npm 5.x`发布以来到现在的`npm 5.6.0`，`lock`的作用变更过好多次。从`npm 3.x`更新到了`npm 5`，但是发现执行`npm i`时的现象跟网络上的科普文不太一致。

有提到不管怎么修改`package.json`文件，重复执行`npm i`，`npm`都会根据`package-lock.json`文件描述的版本信息进行下载。
也有提到重复`npm i`时，`npm`会不顾`package-lock.json`的信息，
根据`package.json`中的包 Semantic versioning 版本信息下载更新模块（`package-lock.json`貌似没啥用了）。

查阅资料得知，自`npm 5.0`版本发布以来，`npm i`的规则发生了三次变化。

1. `npm 5.0.x`版本，不管`package.json`怎么变，`npm i`时都会根据`package-lock.json`文件下载。
[package-lock.json file not updated after package.json file is changed · Issue #16866 · npm/npm](https://github.com/npm/npm/issues/16866)这个`issue`控诉了这个问题，明明手动改了`package.json`，为啥不给我升级包！然后就导致了`npm 5.1.0`的问题。
2. `npm 5.1.0`版本后`npm i`会无视`package-lock.json`文件，而是去下载最新的包。然后就有人提了这个`issue`[why is package-lock being ignored? · Issue #17979 · npm/npm](https://github.com/npm/npm/issues/17979)控诉这个问题，最后演变成`npm 5.4.2`版本后的规则。
3. `npm 5.4.2`版本后，[why is package-lock being ignored? · Issue #17979 · npm/npm](https://github.com/npm/npm/issues/17979)。大致意思是，如果改了`package.json`，且`package.json`和`package-lock.json`文件不同，那么执行`npm i`时`npm`会根据`package.json`中的版本号以及语义含义去下载最新的包，并更新至`package-lock.json`。如果两者是同一状态，那么执行`npm i`都会根据`package-lock.json`下载，不会理会`package.json`实际包的版本是否有新。
